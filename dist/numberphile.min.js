(function(){var a,b,c,d,e=[].slice;if(c=function(){function b(a,b){null==b&&(b={}),this.root=a,c=b.decimalPrecision||2,this.repr=d(this.root)}var c,d,e,f,g,h;return g="int",f="float",h="number",c=2,d=function(b){var c;return c=new a,"string"==typeof b?(c.type=f,c.origin=e(b)):"number"==typeof b&&(c.type=h,c.origin=b),c.set(e(b)),c},e=function(a){var b,c;return"string"==typeof a&&(c=a.match(/\./g),b=a.match(/,/g),b=null!=b?b.length:0,c=null!=c?c.length:0,(b>0||0===b&&c>1)&&c>0&&(a=a.replace(/\./g,"")),a=a.replace(/,/g,".")),parseFloat(a)},b.prototype.add=function(b){return this.repr.set(this.repr.value+a.toFixed(e(b))),this},b.prototype.divide=function(b){return this.repr.set(this.repr.value/a.toFixed(e(b))),this},b.prototype.mod=function(b){return this.repr.set(this.repr.value%a.toFixed(e(b))),this},b.prototype.multiply=function(b){return this.repr.set(this.repr.value*a.toFixed(e(b))),this},b.prototype.subtract=function(b){return this.repr.set(this.repr.value-a.toFixed(e(b))),this},b.prototype.result=function(){return this.val()},b.prototype.value=function(){return this.val()},b.prototype.val=function(a){var b,c;return null==a&&(a=null),null==a&&(a="float"),""===a&&(a="float"),b=this.repr.value,"float"===a&&(c=b),"import"===a&&(c=smartToFixed(b).replace(/\./g,",").replace(/\B(?=(\d{3})+(?!\d))/g,".")),c},b}(),b=function(){function a(a,b,c){this.firstFactor=null!=a?a:null,this.secondFactor=null!=b?b:null,this.operator=null!=c?c:null,this.result=0,this.remainder=null}return a}(),a=function(){function a(a){this.origin=null!=a?a:0,this.value=this.origin,this.type="unknown"}return a.prototype.intPart=function(){},a.prototype.decimalPart=function(){},a.prototype.set=function(b){var c;return c=a.toFixed(b),this.value=parseFloat(c),this.value},a.toFixed=function(a,b){var c,d,e,f,g;return b=b||2,e=0>a,g=Math.pow(10,b),a=Math.round(a*g),d=String((e?Math.ceil:Math.floor)(a/g)),c=String((e?-a:a)%g),f=new Array(Math.max(b-c.length,0)+1).join("0"),parseFloat(b?d+"."+f+c:d)},a}(),"undefined"!=typeof exports&&null!==exports&&(exports.Numberphiler=c),"undefined"!=typeof window&&null!==window&&(this.N=function(a){return new c(a)}),"undefined"!=typeof window&&null!==window){if("undefined"==typeof $||null===$)throw new Error("jQuery is required by NumberphileJS when running in a browser");d=$}else d=require("underscore");this.NumberphileReactor=function(){function a(){}var b;return b=null,a.get=function(){return null==this.instance&&(b=new this,b.init("NumberphileReactor")),b},a.prototype.regexps={thousandsMatch:/\B(?=(\d{3})+(?!\d))/g,importTypableCharacter:/[0-9,\.]/g,importNonValidCharacters:/[^A-Za-z\d,]/g},a.prototype.defaults={debug:!1,importDecimalSeparator:",",importThoudandsSeparator:".",importMaxDecimalDigits:2},a.prototype.init=function(a,b){return null==a&&(a="unknown"),null==b&&(b={}),this.settings=d.extend(this.defaults,b),this.log(""+a+" initialized")},a.prototype.setup=function(a){return null!=a&&(this.settings=d.extend(this.defaults,a)),this.settings},a.prototype.log=function(a){return("undefined"!=typeof console&&null!==console?console.log:void 0)&&this.settings.debug?console.log(a):void 0},a.prototype.stringToFloat=function(a){return parseFloat(a.toString().replace(this.regexps.importNonValidCharacters,"").replace(this.settings.importDecimalSeparator,this.settings.importThoudandsSeparator))},a.prototype.numberToFormattedImport=function(a){return this.stringToFormattedImport(a.toString())},a.prototype.stringToFormattedImport=function(a){var b,c,d,e,f,g,h;if(e="","string"==typeof a){if(f=a.indexOf(this.settings.importDecimalSeparator),-1===f)this.log("No decimals found by character "+this.settings.importDecimalSeparator),e=a+this.settings.importDecimalSeparator+"00";else{if(c=a.split(this.settings.importDecimalSeparator)[0],b=a.split(this.settings.importDecimalSeparator)[1],b.length>this.settings.importMaxDecimalDigits?b=b.substring(0,this.settings.importMaxDecimalDigits):g=b.length>this.settings.importMaxDecimalDigits?0:this.settings.importMaxDecimalDigits-b.length,0!==g)for(d=h=1;g>=1?g>=h:h>=g;d=g>=1?++h:--h)b+="0";this.log("int part: "+c+" decimal part: "+b),e=c+this.settings.importDecimalSeparator+b}return e=e.replace(this.regexps.thousandsMatch,this.settings.importThoudandsSeparator),this.log("final representation: "+e),e}return a},a.prototype.add=function(a){var b,c,d,e;for(null==a&&(a=[]),b=0,d=0,e=a.length;e>d;d++)c=a[d],"string"==typeof c&&(c=this.stringToFloat(c)),b+=c;return b},a.prototype.sum=function(a){return null!=a?"[object Array]"===Object.prototype.toString.call(a)?this.sumImpl(a):"string"==typeof a?this.sumImpl(a.split("|")):0:null},a.prototype.sumImpl=function(a){var b,c,d,e,f;for(d=0,e=0,f=a.length;f>e;e++)c=a[e],b=c,"string"==typeof b&&(b=this.stringToFloat(b)),d+=b;return parseFloat(d.toFixed(this.settings.importMaxDecimalDigits))},a}(),"undefined"!=typeof exports&&null!==exports&&(exports.NumberphileReactor=this.NumberphileReactor),this.NumberphileCounter=function(){function a(a,b){return this.element=a,this.settings=$.extend(this.defaults,b),this.settings.step=parseInt(this.settings.step,10),this.initialize()}return a.prototype.defaults={debug:!1,autowire:!0,step:1,target:null},a.prototype.initialize=function(){return null==this.settings.target&&(this.settings.target=null!=this.element.attr("data-target")&&""!==this.element.attr("data-target")?$(this.element.attr("data-target")):this.element),this.settings.autowire&&this.element.bind("click",function(){return $(this).numberphileCounter("step")}),this},a.prototype.step=function(){var a,b;return a=this.element.attr("data-step"),b=$(this.element.attr("data-target")),b.each(function(){var b,c,d;return b=$(this),c=parseFloat(b.val()),d=parseFloat(a),d+=c,b.is("input")?$(this).val(d):b.text(d),b.trigger("numberphile:step")})},a}(),"undefined"!=typeof window&&null!==window&&"undefined"!=typeof $&&null!==$&&(!function(a){return a.fn.extend({numberphileCounter:function(){var b,c;return c=arguments[0],b=2<=arguments.length?e.call(arguments,1):[],this.each(function(){var d,e;return d=a(this),e=d.data("numberphileCounter-class"),e||d.data("numberphileCounter-class",e=new NumberphileCounter(d,c)),"string"==typeof c?e[c].apply(e,b):void 0})}})}(window.jQuery,window),!function(a){return a(window).bind("load",function(){return a('[role="counter-trigger"]').each(function(){var b,c,d;b=a(this);try{if(c=b.data(),null!=c)return b.numberphileCounter(c)}catch(e){return d=e,b.numberphileCounter({step:b.attr("data-step")||1,target:b.attr("data-target")||""})}})})}(window.jQuery)),this.Numberphile=function(){function a(a,b){return this.element=a,this.settings=$.extend(this.defaults,b),this.initialize(),this}var b,c,d;return a.prototype._f_selectors={numberInput:"input[type=text], input[type=number]"},d={thousandsMatch:/\B(?=(\d{3})+(?!\d))/g,importTypableCharacter:/[0-9,\.]/g},a.prototype.defaults={debug:!1,autowire:!0,importMaxDecimalDigits:2,importDecimalSeparator:",",importThoudandsSeparator:"."},a.prototype.initialize=function(){return this.settings.autowire&&"import"===this.element.attr("data-format")?this.element.bind("blur",function(){return $(this).numberphile("formatImportToHumanReadableFormat")}).bind("focusin",function(){return $(this).numberphile("editModeForImport")}).keydown(function(a){return c(a)?void 0:a.preventDefault()}).val(NumberphileReactor.get().numberToFormattedImport(this.element.val())):void 0},a.prototype.humanReadableImportToNumber=function(){return this.element.is(this._f_selectors.numberInput)?this.element.val(this.SToNumber(this.element.val())):void 0},a.prototype.editModeForImport=function(){return this.element.is(this._f_selectors.numberInput)?this.element.val(this.SToNumber(this.element.val()).toString().replace(".",this.settings.importDecimalSeparator)):void 0},a.prototype.formatImportToHumanReadableFormat=function(){return this.element.is(this._f_selectors.numberInput)?this.element.val(this.numberToS(this.element.val())):void 0},c=function(a){return 188===a.keyCode||46===a.keyCode||8===a.keyCode||9===a.keyCode||27===a.keyCode||13===a.keyCode||65===a.keyCode&&a.ctrlKey===!0||a.keyCode>=35&&a.keyCode<=39?!0:a.shiftKey||(a.keyCode<48||a.keyCode>57)&&(a.keyCode<96||a.keyCode>105)?!1:!0},b=function(a){var b,c;return a=a||window.event,b=a.which||a.keyCode,c=String.fromCharCode(b)},a.prototype.log=function(a){return this.settings&&("undefined"!=typeof console&&null!==console?console.log:void 0)&&this.settings.debug?console.log(a):void 0},a.prototype.SToNumber=function(a){return NumberphileReactor.get().stringToFloat(a)},a.prototype.numberToS=function(a){return NumberphileReactor.get().stringToFormattedImport(a)},a}(),"undefined"!=typeof $&&null!==$&&"undefined"!=typeof window&&null!==window&&!function(a){return a.fn.extend({numberphile:function(){var b,c;return c=arguments[0],b=2<=arguments.length?e.call(arguments,1):[],this.each(function(){var d,e;return d=a(this),e=d.data("numberphile-class"),e||d.data("numberphile-class",e=new Numberphile(d,c)),"string"==typeof c?e[c].apply(e,b):void 0})}})}(window.jQuery,window),"undefined"!=typeof window&&null!==window&&"undefined"!=typeof $&&null!==$&&!function(a){return a(window).bind("load",function(){return a('[data-numberphile="auto"]').numberphile()})}(window.jQuery)}).call(this);