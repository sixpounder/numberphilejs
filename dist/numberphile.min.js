(function(){var a,b=[].slice;if("undefined"!=typeof window&&null!==window){if("undefined"==typeof $||null===$)throw new Error("jQuery is required by NumberphileJS when running in a browser");a=$}else a=require("underscore");this.NumberphileReactor=function(){function b(){}var c;return c=null,b.get=function(){return null==this.instance&&(c=new this,c.init("NumberphileReactor")),c},b.prototype.regexps={thousandsMatch:/\B(?=(\d{3})+(?!\d))/g,importTypableCharacter:/[0-9,\.]/g,importNonTypableCharacters:/[^A-Za-z\d,]/g},b.prototype.defaults={debug:!1,importDecimalSeparator:",",importThoudandsSeparator:".",importMaxDecimalDigits:2},b.prototype.init=function(b,c){return null==b&&(b="unknown"),null==c&&(c={}),this.settings=a.extend(this.defaults,c),this.log(""+b+" initialized")},b.prototype.setup=function(b){return null!=b?this.settings=a.extend(this.defaults,b):void 0},b.prototype.log=function(a){return("undefined"!=typeof console&&null!==console?console.log:void 0)&&this.settings.debug?console.log(a):void 0},b.prototype.stringToFloat=function(a){return parseFloat(a.toString().replace(this.regexps.importNonTypableCharacters,"").replace(this.settings.importDecimalSeparator,this.settings.importThoudandsSeparator))},b.prototype.numberToFormattedImport=function(a){return this.stringToFormattedImport(a.toString())},b.prototype.stringToFormattedImport=function(a){var b,c,d,e,f,g,h;if(e="","string"==typeof a){if(f=a.indexOf(this.settings.importDecimalSeparator),-1===f)this.log("No decimals found by character "+this.settings.importDecimalSeparator),e=a+this.settings.importDecimalSeparator+"00";else{if(c=a.split(this.settings.importDecimalSeparator)[0],b=a.split(this.settings.importDecimalSeparator)[1],b.length>this.settings.importMaxDecimalDigits?b=b.substring(0,this.settings.importMaxDecimalDigits):g=b.length>this.settings.importMaxDecimalDigits?0:this.settings.importMaxDecimalDigits-b.length,0!==g)for(d=h=1;g>=1?g>=h:h>=g;d=g>=1?++h:--h)b+="0";this.log("int part: "+c+" decimal part: "+b),e=c+this.settings.importDecimalSeparator+b}return e=e.replace(this.regexps.thousandsMatch,this.settings.importThoudandsSeparator),this.log("final representation: "+e),e}return a},b.prototype.sum=function(a){return null!=a?"[object Array]"===Object.prototype.toString.call(a)?this.sumImpl(a):"string"==typeof a?this.sumImpl(a.split("|")):0:null},b.prototype.sumImpl=function(a){var b,c,d,e,f;for(d=0,e=0,f=a.length;f>e;e++)c=a[e],b=c,"string"==typeof b&&(b=this.stringToFloat(b)),d+=b;return parseFloat(d.toFixed(this.settings.importMaxDecimalDigits))},b}(),"undefined"!=typeof module&&null!==module&&(module.exports=this.NumberphileReactor),this.Numberphile=function(){function a(a,b){this.element=a,this.settings=$.extend(this.defaults,b),this.initialize()}var b,c,d;return a.prototype._f_selectors={numberInput:"input[type=text], input[type=number]"},d={thousandsMatch:/\B(?=(\d{3})+(?!\d))/g,importTypableCharacter:/[0-9,\.]/g},a.prototype.defaults={debug:!1,autowire:!0,importMaxDecimalDigits:2,importDecimalSeparator:",",importThoudandsSeparator:"."},a.prototype.initialize=function(){return this.settings.autowire&&"import"===this.element.attr("data-format")?this.element.on("blur",function(){return $(this).numberphile("formatImportToHumanReadableFormat")}).on("focusin",function(){return $(this).numberphile("editModeForImport")}).keydown(function(a){return c(a)?void 0:a.preventDefault()}).val(NumberphileReactor.get().numberToFormattedImport(this.element.val())):void 0},a.prototype.humanReadableImportToNumber=function(){return this.element.is(this._f_selectors.numberInput)?this.element.val(this.SToNumber(this.element.val())):void 0},a.prototype.editModeForImport=function(){return this.element.is(this._f_selectors.numberInput)?this.element.val(this.SToNumber(this.element.val()).toString().replace(".",this.settings.importDecimalSeparator)):void 0},a.prototype.formatImportToHumanReadableFormat=function(){return this.element.is(this._f_selectors.numberInput)?this.element.val(this.numberToS(this.element.val())):void 0},c=function(a){return 188===a.keyCode||46===a.keyCode||8===a.keyCode||9===a.keyCode||27===a.keyCode||13===a.keyCode||65===a.keyCode&&a.ctrlKey===!0||a.keyCode>=35&&a.keyCode<=39?!0:a.shiftKey||(a.keyCode<48||a.keyCode>57)&&(a.keyCode<96||a.keyCode>105)?!1:!0},b=function(a){var b,c;return a=a||window.event,b=a.which||a.keyCode,c=String.fromCharCode(b)},a.prototype.log=function(a){return this.settings&&("undefined"!=typeof console&&null!==console?console.log:void 0)&&this.settings.debug?console.log(a):void 0},a.prototype.SToNumber=function(a){return NumberphileReactor.get().stringToFloat(a)},a.prototype.numberToS=function(a){return NumberphileReactor.get().stringToFormattedImport(a)},a}(),"undefined"!=typeof $&&null!==$&&"undefined"!=typeof window&&null!==window&&!function(a){return a.fn.extend({numberphile:function(){var c,d;return d=arguments[0],c=2<=arguments.length?b.call(arguments,1):[],this.each(function(){var b,e;return b=a(this),e=b.data("numberphile-class"),e||b.data("numberphile-class",e=new Numberphile(b,d)),"string"==typeof d?e[d].apply(e,c):void 0})}})}(window.jQuery,window),"undefined"!=typeof window&&null!==window&&"undefined"!=typeof $&&null!==$&&!function(a){return a(window).on("load",function(){return a('[data-numberphile="auto"]').numberphile()})}(window.jQuery)}).call(this);